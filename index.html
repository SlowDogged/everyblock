<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Minecraft Block Checklist</title>
  <style>
    :root {
      --bg: #f4f4f4;
      --fg: #222;
      --card: #fff;
      --shadow: rgba(0,0,0,0.1);
    }
    [data-theme="dark"] {
      --bg: #1e1e1e;
      --fg: #ddd;
      --card: #2a2a2a;
      --shadow: rgba(0,0,0,0.5);
    }
    * { box-sizing:border-box; margin:0; padding:0 }
    body {
      background: var(--bg);
      color: var(--fg);
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      background: var(--card);
      box-shadow: 0 2px 4px var(--shadow);
    }
    header h1 { font-size: 1.2rem }
    .toggle {
      font-size: 1.5rem;
      cursor: pointer;
      user-select: none;
    }
    #list {
      flex: 1;
      padding: 1rem;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
      overflow-y: auto;
    }
    .item {
      background: var(--card);
      padding: .75rem;
      border-radius: 6px;
      box-shadow: 0 1px 3px var(--shadow);
      display: flex;
      align-items: center;
    }
    .item input { margin-right: .5rem }
    .error {
      padding: 2rem;
      text-align: center;
      color: crimson;
    }
  </style>
</head>
<body>
  <header>
    <h1>üî≤ Minecraft Blocks</h1>
    <div class="toggle" id="dmToggle" title="Toggle Dark Mode">üåì</div>
  </header>
  <div id="list">Loading‚Ä¶</div>

  <script>
  // ‚Äî‚Äî Dark‚Äêmode toggle & persistence ‚Äî‚Äî 
  const root = document.documentElement;
  const savedTheme = localStorage.getItem('theme') || 'light';
  root.setAttribute('data-theme', savedTheme);
  document.getElementById('dmToggle').onclick = () => {
    const next = root.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
    root.setAttribute('data-theme', next);
    localStorage.setItem('theme', next);
  };

  // ‚Äî‚Äî Source for all MC 1.21.3 blocks ‚Äî‚Äî
  const JSON_URL = 'https://raw.githubusercontent.com/PrismarineJS/minecraft-data/master/data/pc/1.21.3/blocks.json';

  // ‚Äî‚Äî Our in‚Äêmemory state, persisted per‚Äêuser ‚Äî‚Äî 
  let blockState = JSON.parse(localStorage.getItem('blockState') || '{}');

  // ‚Äî‚Äî Render the checklist ‚Äî‚Äî 
  async function init() {
    try {
      const res  = await fetch(JSON_URL);
      if (!res.ok) throw new Error(res.statusText);
      const data = await res.json();
      // extract names, skip debug entries, sort
      const names = data
        .map(b => b.displayName || b.name)
        .filter(n => n && !n.startsWith('debug:'))
        .sort((a, b) => a.localeCompare(b));

      // ensure every block has a boolean in blockState
      names.forEach(n => {
        if (typeof blockState[n] !== 'boolean') {
          blockState[n] = false;
        }
      });

      const container = document.getElementById('list');
      container.innerHTML = '';

      names.forEach(name => {
        const id = 'blk_' + name.replace(/[^a-z0-9]/gi, '_');
        const label = document.createElement('label');
        label.className = 'item';
        label.innerHTML = `
          <input type="checkbox" id="${id}">
          <span>${name}</span>
        `;
        const cb = label.querySelector('input');
        cb.checked = blockState[name];
        cb.addEventListener('change', () => {
          blockState[name] = cb.checked;
          // persist per‚Äêuser
          localStorage.setItem('blockState', JSON.stringify(blockState));
        });
        container.appendChild(label);
      });
    } catch (err) {
      document.getElementById('list').innerHTML =
        `<div class="error">Failed to load blocks:<br>${err.message}</div>`;
    }
  }

  init();
  </script>
</body>
</html>
