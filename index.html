<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Minecraft Block Checklist</title>
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
  <style>
    :root {
      --bg-light: #f0f0f0;
      --bg-dark: #121212;
      --card-light: #ffffff;
      --card-dark: #1e1e1e;
      --text-light: #000000;
      --text-dark: #ffffff;
      --accent: #4caf50;
    }
    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0; padding: 0;
      background: var(--bg-light);
      color: var(--text-light);
      transition: background 0.3s, color 0.3s;
    }
    body.dark {
      background: var(--bg-dark);
      color: var(--text-dark);
    }
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 24px;
      background: var(--card-light);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    body.dark header {
      background: var(--card-dark);
    }
    h1 { margin: 0; font-size: 1.5em; }
    #theme-toggle {
      background: none;
      border: none;
      font-size: 1.2em;
      cursor: pointer;
    }
    main {
      max-width: 600px;
      margin: 24px auto;
      padding: 0 16px;
    }
    .item {
      display: flex;
      align-items: center;
      background: var(--card-light);
      padding: 12px 16px;
      border-radius: 8px;
      margin-bottom: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      transition: background 0.3s;
    }
    body.dark .item {
      background: var(--card-dark);
      box-shadow: 0 1px 3px rgba(255,255,255,0.05);
    }
    .item input[type="checkbox"] {
      margin-right: 12px;
      width: 18px;
      height: 18px;
      accent-color: var(--accent);
    }
  </style>
</head>
<body>
  <header>
    <h1>Minecraft Block Checklist 🧱</h1>
    <button id="theme-toggle" aria-label="Toggle Dark Mode">🌙</button>
  </header>
  <main>
    <div id="checklist">Loading blocks...</div>
  </main>

  <script>
    // --- Theme toggle ---
    const toggleBtn = document.getElementById('theme-toggle');
    const isDark = localStorage.getItem('darkMode') === 'true';
    document.body.classList.toggle('dark', isDark);
    toggleBtn.textContent = isDark ? '☀️' : '🌙';
    toggleBtn.addEventListener('click', () => {
      const dark = document.body.classList.toggle('dark');
      toggleBtn.textContent = dark ? '☀️' : '🌙';
      localStorage.setItem('darkMode', dark);
    });

    // --- Firebase init ---
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "...",
      appId: "..."
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // --- Load block names (column B) ---
    const sheetCsvUrl = 'https://docs.google.com/spreadsheets/d/1S3jBzfy_PtJhQI_5jFIN3lXBiUEMebt_rT2x5os2MYw/export?format=csv';
    const checklistEl = document.getElementById('checklist');
    checklistEl.innerHTML = '';

    fetch(sheetCsvUrl)
      .then(res => res.text())
      .then(csv => {
        const lines = csv.split('\n').filter(l => l.trim());
        const dataRows = lines.slice(1);
        dataRows.forEach(row => {
          const cols = row.split(',');
          const name = cols[1]?.trim();
          if (!name) return;

          const key = name.replace(/\s+/g, '_');
          const path = `checks/${key}`;

          const item = document.createElement('div'); item.className = 'item';
          const cb = document.createElement('input'); cb.type = 'checkbox';
          const id = `cb_${key}`; cb.id = id;
          const label = document.createElement('label'); label.htmlFor = id; label.textContent = name;

          // realtime listener
          db.ref(path).on('value', snap => {
            cb.checked = snap.val() === true;
          });

          // update on change
          cb.addEventListener('change', () => {
            db.ref(path).set(cb.checked);
          });

          item.append(cb, label);
          checklistEl.appendChild(item);
        });
      })
      .catch(err => {
        checklistEl.textContent = 'Failed to load block list.';
        console.error(err);
      });
  </script>
</body>
</html>
